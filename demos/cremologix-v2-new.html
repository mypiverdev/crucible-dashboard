<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CremoLogix - Small Business Lending Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --deep-navy: #0A2540;
            --dark-teal: #006D77;
            --warm-gold: #F4A261;
            --amber: #E76F51;
            --success: #2A9D8F;
            --warning: #F4A261;
            --danger: #E63946;
            --bg-white: #FFFFFF;
            --bg-light: #F8F9FA;
            --bg-gray: #E9ECEF;
            --text-dark: #212529;
            --text-medium: #6C757D;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--deep-navy);
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-logo {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--warm-gold);
        }

        .sidebar-nav {
            list-style: none;
        }

        .sidebar-nav li {
            margin-bottom: 5px;
        }

        .sidebar-nav a {
            display: block;
            padding: 12px 16px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .sidebar-nav a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .sidebar-nav a.active {
            background: var(--dark-teal);
            color: white;
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 40px;
            max-width: 1400px;
        }

        /* Role Switcher */
        .role-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
        }

        .role-switcher label {
            font-weight: 600;
            margin-right: 10px;
            color: var(--text-medium);
        }

        .role-switcher select {
            padding: 8px 16px;
            border: 2px solid var(--bg-gray);
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            background: white;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--deep-navy) 0%, var(--dark-teal) 100%);
            color: white;
            padding: 80px 40px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 40px;
        }

        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .hero p {
            font-size: 20px;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .hero-cta {
            display: inline-flex;
            gap: 20px;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 14px 32px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        .btn-primary {
            background: var(--warm-gold);
            color: var(--deep-navy);
        }

        .btn-primary:hover {
            background: var(--amber);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: white;
            color: var(--deep-navy);
        }

        .btn-secondary:hover {
            background: var(--bg-light);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #239186;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--dark-teal);
            color: var(--dark-teal);
        }

        .btn-outline:hover {
            background: var(--dark-teal);
            color: white;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 20px;
        }

        .card h2 {
            color: var(--deep-navy);
            margin-bottom: 20px;
            font-size: 24px;
        }

        .card h3 {
            color: var(--deep-navy);
            margin-bottom: 15px;
            font-size: 18px;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card-icon {
            width: 60px;
            height: 60px;
            background: var(--bg-light);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin-bottom: 20px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--bg-gray);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--dark-teal);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Stats Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
        }

        .stat-label {
            color: var(--text-medium);
            font-size: 14px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--deep-navy);
        }

        .stat-change {
            font-size: 14px;
            margin-top: 8px;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-gray);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--dark-teal), var(--success));
            transition: width 0.3s ease;
        }

        /* Gauge */
        .gauge {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .gauge-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                var(--success) 0deg,
                var(--success) var(--gauge-angle, 0deg),
                var(--bg-gray) var(--gauge-angle, 0deg),
                var(--bg-gray) 360deg
            );
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gauge-inner {
            width: 150px;
            height: 150px;
            background: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .gauge-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--deep-navy);
        }

        .gauge-label {
            font-size: 14px;
            color: var(--text-medium);
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
        }

        .badge-success {
            background: rgba(42, 157, 143, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(244, 162, 97, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(230, 57, 70, 0.1);
            color: var(--danger);
        }

        .badge-info {
            background: rgba(0, 109, 119, 0.1);
            color: var(--dark-teal);
        }

        /* Table */
        .table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .table th {
            background: var(--bg-light);
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
        }

        .table td {
            padding: 16px;
            border-top: 1px solid var(--bg-gray);
        }

        .table tr:hover {
            background: var(--bg-light);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--bg-gray);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 30px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -45px;
            top: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--dark-teal);
            border: 3px solid white;
            box-shadow: 0 0 0 2px var(--dark-teal);
        }

        .timeline-item.completed::before {
            background: var(--success);
            box-shadow: 0 0 0 2px var(--success);
        }

        .timeline-date {
            font-size: 14px;
            color: var(--text-medium);
            margin-bottom: 5px;
        }

        .timeline-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow-sm);
        }

        /* Gate Stepper */
        .gate-stepper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 40px;
            padding: 30px;
            background: white;
            border-radius: 12px;
        }

        .gate-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .gate-step::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 20px;
            width: 100%;
            height: 2px;
            background: var(--bg-gray);
            z-index: 0;
        }

        .gate-step:last-child::after {
            display: none;
        }

        .gate-step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-gray);
            color: var(--text-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            z-index: 1;
            margin-bottom: 10px;
        }

        .gate-step.active .gate-step-circle {
            background: var(--dark-teal);
            color: white;
        }

        .gate-step.completed .gate-step-circle {
            background: var(--success);
            color: white;
        }

        .gate-step.completed::after {
            background: var(--success);
        }

        .gate-step-label {
            font-size: 14px;
            font-weight: 600;
            text-align: center;
        }

        /* Integration Cards */
        .integration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .integration-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            border: 2px solid var(--bg-gray);
            transition: all 0.3s;
        }

        .integration-card:hover {
            border-color: var(--dark-teal);
            box-shadow: var(--shadow-md);
        }

        .integration-card.connected {
            border-color: var(--success);
            background: rgba(42, 157, 143, 0.02);
        }

        .integration-icon {
            width: 60px;
            height: 60px;
            background: var(--bg-light);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin-bottom: 16px;
        }

        .integration-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--deep-navy);
            margin-bottom: 8px;
        }

        .integration-desc {
            font-size: 14px;
            color: var(--text-medium);
            margin-bottom: 16px;
        }

        /* Live Terms Sidebar */
        .terms-sidebar {
            position: sticky;
            top: 20px;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-md);
            border: 2px solid var(--dark-teal);
        }

        .terms-sidebar h3 {
            color: var(--deep-navy);
            margin-bottom: 20px;
            font-size: 20px;
        }

        .terms-item {
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg-light);
            border-radius: 8px;
            transition: all 0.3s;
        }

        .terms-item.updated {
            animation: termFlash 0.6s ease;
        }

        @keyframes termFlash {
            0%, 100% {
                background: var(--bg-light);
            }
            50% {
                background: rgba(42, 157, 143, 0.2);
            }
        }

        .terms-label {
            font-size: 14px;
            color: var(--text-medium);
            margin-bottom: 4px;
        }

        .terms-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--deep-navy);
        }

        .terms-improvement {
            font-size: 12px;
            color: var(--success);
            margin-top: 4px;
        }

        /* Bar Chart */
        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 200px;
            gap: 20px;
            margin: 20px 0;
        }

        .bar {
            flex: 1;
            background: linear-gradient(180deg, var(--dark-teal), var(--success));
            border-radius: 8px 8px 0 0;
            position: relative;
            transition: all 0.3s;
        }

        .bar:hover {
            opacity: 0.8;
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 12px;
            color: var(--text-medium);
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 14px;
            font-weight: 700;
            color: var(--deep-navy);
        }

        /* Heatmap */
        .heatmap {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin: 20px 0;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .heatmap-cell:hover {
            transform: scale(1.1);
        }

        .heatmap-cell.low {
            background: rgba(42, 157, 143, 0.2);
            color: var(--success);
        }

        .heatmap-cell.medium {
            background: rgba(244, 162, 97, 0.3);
            color: var(--warning);
        }

        .heatmap-cell.high {
            background: rgba(230, 57, 70, 0.3);
            color: var(--danger);
        }

        /* Alert */
        .alert {
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .alert-success {
            background: rgba(42, 157, 143, 0.1);
            color: var(--success);
            border-left: 4px solid var(--success);
        }

        .alert-warning {
            background: rgba(244, 162, 97, 0.1);
            color: var(--warning);
            border-left: 4px solid var(--warning);
        }

        .alert-danger {
            background: rgba(230, 57, 70, 0.1);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }

        .alert-info {
            background: rgba(0, 109, 119, 0.1);
            color: var(--dark-teal);
            border-left: 4px solid var(--dark-teal);
        }

        /* Mini Dashboard */
        .mini-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .mini-card {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .mini-card-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--deep-navy);
            margin-bottom: 8px;
        }

        .mini-card-label {
            font-size: 14px;
            color: var(--text-medium);
        }

        /* Two Column Layout */
        .two-col-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in {
            animation: slideIn 0.5s ease;
        }

        /* Utility Classes */
        .text-center {
            text-align: center;
        }

        .text-muted {
            color: var(--text-medium);
        }

        .mt-1 { margin-top: 10px; }
        .mt-2 { margin-top: 20px; }
        .mt-3 { margin-top: 30px; }
        .mb-1 { margin-bottom: 10px; }
        .mb-2 { margin-bottom: 20px; }
        .mb-3 { margin-bottom: 30px; }

        .p-1 { padding: 10px; }
        .p-2 { padding: 20px; }
        .p-3 { padding: 30px; }

        .hidden {
            display: none;
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid var(--bg-gray);
            border-top: 4px solid var(--dark-teal);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 40px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Feature Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .feature-item {
            text-align: center;
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--dark-teal), var(--success));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin: 0 auto 20px;
            color: white;
        }

        .feature-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--deep-navy);
            margin-bottom: 10px;
        }

        .feature-desc {
            color: var(--text-medium);
        }

        /* Checklist */
        .checklist {
            list-style: none;
        }

        .checklist li {
            padding: 12px 0;
            border-bottom: 1px solid var(--bg-gray);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .checklist li:last-child {
            border-bottom: none;
        }

        .checklist-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--success);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .checklist-icon.pending {
            background: var(--bg-gray);
            color: var(--text-medium);
        }

        /* Document List */
        .doc-list {
            list-style: none;
        }

        .doc-item {
            background: white;
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-sm);
        }

        .doc-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .doc-icon {
            width: 40px;
            height: 40px;
            background: var(--bg-light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .doc-name {
            font-weight: 600;
            color: var(--deep-navy);
        }

        .doc-size {
            font-size: 14px;
            color: var(--text-medium);
        }

        /* Mentor Card */
        .mentor-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }

        .mentor-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--dark-teal), var(--success));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
        }

        .mentor-info {
            flex: 1;
        }

        .mentor-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--deep-navy);
            margin-bottom: 5px;
        }

        .mentor-title {
            color: var(--text-medium);
            margin-bottom: 10px;
        }

        .mentor-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }

        .mentor-stat {
            color: var(--text-medium);
        }

        .mentor-stat strong {
            color: var(--deep-navy);
        }
    </style>
</head>
<body>
    <div class="role-switcher">
        <label for="roleSelect">View as:</label>
        <select id="roleSelect" onchange="switchRole()">
            <option value="borrower">Borrower</option>
            <option value="lender">Lender</option>
            <option value="underwriter">Underwriter</option>
            <option value="mentor">Mentor</option>
            <option value="servicer">Servicer</option>
            <option value="admin">Admin</option>
            <option value="investor">Investor</option>
        </select>
    </div>

    <div class="app-container">
        <nav class="sidebar" id="sidebar">
            <!-- Navigation will be populated by JS -->
        </nav>

        <main class="main-content" id="mainContent">
            <!-- Content will be populated by JS -->
        </main>
    </div>

    <script>
        // State Management
        const appState = {
            currentRole: 'borrower',
            currentScreen: 'landing',
            loanData: {
                requestedAmount: 50000,
                rate: 9.25,
                monthlyPayment: 1250,
                integrationsConnected: []
            }
        };

        // Navigation Data for All Roles
        const navigationData = {
            borrower: [
                { id: 'landing', label: 'Home' },
                { id: 'dashboard', label: 'Dashboard' },
                { id: 'gate1-intent', label: 'Gate 1: Intent' },
                { id: 'gate2a-credit', label: 'Gate 2a: Credit' },
                { id: 'gate2b-kyc', label: 'Gate 2b: KYC' },
                { id: 'gate2c-business', label: 'Gate 2c: Business' },
                { id: 'gate25-guestimates', label: 'Gate 2.5: Estimates' },
                { id: 'tier1-terms', label: 'Tier 1 Terms' },
                { id: 'application-fee', label: 'Application Fee' },
                { id: 'gate3-integrations', label: 'Gate 3: Integrations' },
                { id: 'analysis', label: 'Analysis' },
                { id: 'tier2-terms', label: 'Tier 2 Terms' },
                { id: 'under-review', label: 'Under Review' },
                { id: 'approved', label: 'Approved' },
                { id: 'closing', label: 'Closing' },
                { id: 'funded', label: 'Funded' },
                { id: 'my-loans', label: 'My Loans' },
                { id: 'mentorship', label: 'Mentorship' },
                { id: 'financial-health', label: 'Financial Health' }
            ],
            lender: [
                { id: 'lender-dashboard', label: 'Dashboard' },
                { id: 'lender-portfolio', label: 'Portfolio' },
                { id: 'lender-applications', label: 'Applications' },
                { id: 'lender-funding', label: 'Funding Queue' },
                { id: 'lender-performance', label: 'Performance' }
            ],
            underwriter: [
                { id: 'underwriter-dashboard', label: 'Dashboard' },
                { id: 'underwriter-queue', label: 'Review Queue' },
                { id: 'underwriter-application', label: 'Application Detail' },
                { id: 'underwriter-reports', label: 'Reports' }
            ],
            mentor: [
                { id: 'mentor-dashboard', label: 'Dashboard' },
                { id: 'mentor-clients', label: 'My Clients' },
                { id: 'mentor-sessions', label: 'Sessions' },
                { id: 'mentor-resources', label: 'Resources' }
            ],
            servicer: [
                { id: 'servicer-dashboard', label: 'Dashboard' },
                { id: 'servicer-payments', label: 'Payments' },
                { id: 'servicer-collections', label: 'Collections' },
                { id: 'servicer-reports', label: 'Reports' }
            ],
            admin: [
                { id: 'admin-dashboard', label: 'Dashboard' },
                { id: 'admin-users', label: 'Users' },
                { id: 'admin-settings', label: 'Settings' },
                { id: 'admin-compliance', label: 'Compliance' }
            ],
            investor: [
                { id: 'investor-dashboard', label: 'Dashboard' },
                { id: 'investor-opportunities', label: 'Opportunities' },
                { id: 'investor-portfolio', label: 'Portfolio' },
                { id: 'investor-returns', label: 'Returns' }
            ]
        };

        // Screen Functions - BORROWER SCREENS

        function screenLanding() {
            return '<div class="hero">' +
                '<h1>Small Business Lending, Reimagined</h1>' +
                '<p>AI-powered underwriting meets open banking for faster, fairer access to capital</p>' +
                '<div class="hero-cta">' +
                '<a href="#" onclick="navigate(\'signup\')" class="btn btn-primary">Get Started</a>' +
                '<a href="#" onclick="navigate(\'landing\')" class="btn btn-secondary">Learn More</a>' +
                '</div>' +
                '</div>' +
                '<div class="feature-grid">' +
                '<div class="feature-item">' +
                '<div class="feature-icon">‚ö°</div>' +
                '<div class="feature-title">Fast Approval</div>' +
                '<div class="feature-desc">Get decisions in hours, not weeks</div>' +
                '</div>' +
                '<div class="feature-item">' +
                '<div class="feature-icon">üìä</div>' +
                '<div class="feature-title">Data-Driven</div>' +
                '<div class="feature-desc">Your real financial data, not just credit scores</div>' +
                '</div>' +
                '<div class="feature-item">' +
                '<div class="feature-icon">ü§ù</div>' +
                '<div class="feature-title">Mentorship</div>' +
                '<div class="feature-desc">Free business coaching with every loan</div>' +
                '</div>' +
                '<div class="feature-item">' +
                '<div class="feature-icon">üí∞</div>' +
                '<div class="feature-title">Better Rates</div>' +
                '<div class="feature-desc">Transparent pricing, no hidden fees</div>' +
                '</div>' +
                '</div>';
        }

        function screenSignup() {
            return '<div class="card">' +
                '<h2>Create Your Account</h2>' +
                '<form onsubmit="navigate(\'welcome\'); return false;">' +
                '<div class="form-row">' +
                '<div class="form-group">' +
                '<label>First Name</label>' +
                '<input type="text" placeholder="John" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Last Name</label>' +
                '<input type="text" placeholder="Smith" required />' +
                '</div>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Email Address</label>' +
                '<input type="email" placeholder="john@mybusiness.com" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Business Name</label>' +
                '<input type="text" placeholder="Smith & Co." required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Password</label>' +
                '<input type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">Create Account</button>' +
                '</form>' +
                '</div>';
        }

        function screenWelcome() {
            return '<div class="card text-center">' +
                '<h2>Welcome to CremoLogix!</h2>' +
                '<p class="text-muted mb-3">Let us guide you through your loan journey</p>' +
                '<div class="feature-grid">' +
                '<div class="feature-item">' +
                '<div class="feature-icon">üìù</div>' +
                '<div class="feature-title">Step 1: Intent</div>' +
                '<div class="feature-desc">Tell us about your loan needs</div>' +
                '</div>' +
                '<div class="feature-item">' +
                '<div class="feature-icon">‚úì</div>' +
                '<div class="feature-title">Step 2: Verification</div>' +
                '<div class="feature-desc">Quick credit check and identity verification</div>' +
                '</div>' +
                '<div class="feature-item">' +
                '<div class="feature-icon">üîó</div>' +
                '<div class="feature-title">Step 3: Connect Data</div>' +
                '<div class="feature-desc">Link your accounts for better terms</div>' +
                '</div>' +
                '<div class="feature-item">' +
                '<div class="feature-icon">üíµ</div>' +
                '<div class="feature-title">Step 4: Get Funded</div>' +
                '<div class="feature-desc">Receive your funds in 24 hours</div>' +
                '</div>' +
                '</div>' +
                '<button onclick="navigate(\'gate1-intent\')" class="btn btn-primary mt-3">Start Application</button>' +
                '</div>';
        }

        function screenDashboard() {
            return '<h1>Dashboard</h1>' +
                '<div class="stats-grid">' +
                '<div class="stat-card">' +
                '<div class="stat-label">Application Status</div>' +
                '<div class="stat-value">In Progress</div>' +
                '<div class="badge badge-info mt-1">Gate 3</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Loan Amount</div>' +
                '<div class="stat-value">$50,000</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Current Rate</div>' +
                '<div class="stat-value">8.25%</div>' +
                '<div class="stat-change positive">Improved with integrations</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Monthly Payment</div>' +
                '<div class="stat-value">$1,095</div>' +
                '</div>' +
                '</div>' +
                '<div class="card mt-3">' +
                '<h3>Your Progress</h3>' +
                '<div class="progress-bar">' +
                '<div class="progress-fill" style="width: 75%"></div>' +
                '</div>' +
                '<p class="text-muted mt-1">75% Complete - Currently at Gate 3</p>' +
                '</div>' +
                '<div class="card mt-3">' +
                '<h3>Next Steps</h3>' +
                '<ul class="checklist">' +
                '<li><span class="checklist-icon">‚úì</span> Complete application form</li>' +
                '<li><span class="checklist-icon">‚úì</span> Credit check</li>' +
                '<li><span class="checklist-icon">‚úì</span> Identity verification</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Connect bank accounts</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Final approval</li>' +
                '</ul>' +
                '</div>';
        }

        function screenGate1Intent() {
            return '<div class="gate-stepper">' +
                '<div class="gate-step active">' +
                '<div class="gate-step-circle">1</div>' +
                '<div class="gate-step-label">Intent</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">2</div>' +
                '<div class="gate-step-label">Verification</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">3</div>' +
                '<div class="gate-step-label">Integration</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">4</div>' +
                '<div class="gate-step-label">Approval</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h2>Gate 1: Loan Intent</h2>' +
                '<p class="text-muted mb-3">Tell us about your loan needs</p>' +
                '<form onsubmit="navigate(\'gate2a-credit\'); return false;">' +
                '<div class="form-group">' +
                '<label>How much do you need to borrow?</label>' +
                '<input type="number" placeholder="50000" value="50000" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>What will you use the funds for?</label>' +
                '<select required>' +
                '<option value="">Select a purpose</option>' +
                '<option value="expansion">Business Expansion</option>' +
                '<option value="equipment">Equipment Purchase</option>' +
                '<option value="inventory">Inventory</option>' +
                '<option value="working-capital">Working Capital</option>' +
                '<option value="real-estate">Real Estate</option>' +
                '<option value="other">Other</option>' +
                '</select>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Describe your business and loan purpose</label>' +
                '<textarea placeholder="Tell us about your business and how this loan will help you grow..." required></textarea>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Preferred loan term</label>' +
                '<select required>' +
                '<option value="">Select a term</option>' +
                '<option value="12">12 months</option>' +
                '<option value="24">24 months</option>' +
                '<option value="36" selected>36 months</option>' +
                '<option value="48">48 months</option>' +
                '<option value="60">60 months</option>' +
                '</select>' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">Continue to Verification</button>' +
                '</form>' +
                '</div>';
        }

        function screenGate2aCredit() {
            return '<div class="gate-stepper">' +
                '<div class="gate-step completed">' +
                '<div class="gate-step-circle">‚úì</div>' +
                '<div class="gate-step-label">Intent</div>' +
                '</div>' +
                '<div class="gate-step active">' +
                '<div class="gate-step-circle">2</div>' +
                '<div class="gate-step-label">Verification</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">3</div>' +
                '<div class="gate-step-label">Integration</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">4</div>' +
                '<div class="gate-step-label">Approval</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h2>Gate 2a: Credit Check</h2>' +
                '<p class="text-muted mb-3">We need your permission to check your credit</p>' +
                '<div class="alert alert-info">' +
                '<span>‚ÑπÔ∏è</span>' +
                '<span>This is a soft pull and will not affect your credit score</span>' +
                '</div>' +
                '<form onsubmit="navigate(\'gate2b-kyc\'); return false;">' +
                '<div class="form-group">' +
                '<label>Social Security Number</label>' +
                '<input type="text" placeholder="XXX-XX-XXXX" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Date of Birth</label>' +
                '<input type="date" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>' +
                '<input type="checkbox" required /> ' +
                'I authorize CremoLogix to check my credit report' +
                '</label>' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">Run Credit Check</button>' +
                '</form>' +
                '</div>';
        }

        function screenGate2bKyc() {
            return '<div class="gate-stepper">' +
                '<div class="gate-step completed">' +
                '<div class="gate-step-circle">‚úì</div>' +
                '<div class="gate-step-label">Intent</div>' +
                '</div>' +
                '<div class="gate-step active">' +
                '<div class="gate-step-circle">2</div>' +
                '<div class="gate-step-label">Verification</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">3</div>' +
                '<div class="gate-step-label">Integration</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">4</div>' +
                '<div class="gate-step-label">Approval</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h2>Gate 2b: Identity Verification</h2>' +
                '<p class="text-muted mb-3">Verify your identity to continue</p>' +
                '<div class="alert alert-success mb-3">' +
                '<span>‚úì</span>' +
                '<span>Credit check complete - Score: 720</span>' +
                '</div>' +
                '<form onsubmit="navigate(\'gate2c-business\'); return false;">' +
                '<div class="form-row">' +
                '<div class="form-group">' +
                '<label>Street Address</label>' +
                '<input type="text" placeholder="123 Main St" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Apt/Suite</label>' +
                '<input type="text" placeholder="Unit 4" />' +
                '</div>' +
                '</div>' +
                '<div class="form-row">' +
                '<div class="form-group">' +
                '<label>City</label>' +
                '<input type="text" placeholder="San Francisco" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>State</label>' +
                '<select required>' +
                '<option value="">Select State</option>' +
                '<option value="CA">California</option>' +
                '<option value="NY">New York</option>' +
                '<option value="TX">Texas</option>' +
                '</select>' +
                '</div>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>ZIP Code</label>' +
                '<input type="text" placeholder="94105" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Phone Number</label>' +
                '<input type="tel" placeholder="(555) 123-4567" required />' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">Continue</button>' +
                '</form>' +
                '</div>';
        }

        function screenGate2cBusiness() {
            return '<div class="gate-stepper">' +
                '<div class="gate-step completed">' +
                '<div class="gate-step-circle">‚úì</div>' +
                '<div class="gate-step-label">Intent</div>' +
                '</div>' +
                '<div class="gate-step active">' +
                '<div class="gate-step-circle">2</div>' +
                '<div class="gate-step-label">Verification</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">3</div>' +
                '<div class="gate-step-label">Integration</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">4</div>' +
                '<div class="gate-step-label">Approval</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h2>Gate 2c: Business Information</h2>' +
                '<p class="text-muted mb-3">Tell us about your business</p>' +
                '<form onsubmit="navigate(\'gate25-guestimates\'); return false;">' +
                '<div class="form-group">' +
                '<label>Legal Business Name</label>' +
                '<input type="text" placeholder="Smith & Co., LLC" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>DBA (if different)</label>' +
                '<input type="text" placeholder="Doing Business As" />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>EIN (Employer Identification Number)</label>' +
                '<input type="text" placeholder="XX-XXXXXXX" required />' +
                '</div>' +
                '<div class="form-row">' +
                '<div class="form-group">' +
                '<label>Business Type</label>' +
                '<select required>' +
                '<option value="">Select Type</option>' +
                '<option value="llc">LLC</option>' +
                '<option value="corp">Corporation</option>' +
                '<option value="scorp">S-Corp</option>' +
                '<option value="partnership">Partnership</option>' +
                '<option value="sole">Sole Proprietor</option>' +
                '</select>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Industry</label>' +
                '<select required>' +
                '<option value="">Select Industry</option>' +
                '<option value="retail">Retail</option>' +
                '<option value="restaurant">Restaurant</option>' +
                '<option value="services">Professional Services</option>' +
                '<option value="manufacturing">Manufacturing</option>' +
                '<option value="tech">Technology</option>' +
                '</select>' +
                '</div>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Years in Business</label>' +
                '<input type="number" placeholder="5" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Number of Employees</label>' +
                '<input type="number" placeholder="12" required />' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">Continue</button>' +
                '</form>' +
                '</div>';
        }

        function screenGate25Guestimates() {
            return '<div class="gate-stepper">' +
                '<div class="gate-step completed">' +
                '<div class="gate-step-circle">‚úì</div>' +
                '<div class="gate-step-label">Intent</div>' +
                '</div>' +
                '<div class="gate-step active">' +
                '<div class="gate-step-circle">2</div>' +
                '<div class="gate-step-label">Verification</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">3</div>' +
                '<div class="gate-step-label">Integration</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">4</div>' +
                '<div class="gate-step-label">Approval</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h2>Gate 2.5: Financial Estimates</h2>' +
                '<p class="text-muted mb-3">Give us rough estimates - we will verify with actual data later</p>' +
                '<form onsubmit="navigate(\'tier1-terms\'); return false;">' +
                '<div class="form-group">' +
                '<label>Annual Revenue (approximate)</label>' +
                '<input type="number" placeholder="500000" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Monthly Average Bank Balance</label>' +
                '<input type="number" placeholder="25000" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Current Business Debt</label>' +
                '<input type="number" placeholder="50000" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Monthly Revenue (average)</label>' +
                '<input type="number" placeholder="42000" required />' +
                '</div>' +
                '<div class="alert alert-info mt-3">' +
                '<span>‚ÑπÔ∏è</span>' +
                '<span>Do not worry about being exact - connecting your accounts in the next step will give us precise data</span>' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">See My Terms</button>' +
                '</form>' +
                '</div>';
        }

        function screenTier1Terms() {
            return '<div class="card">' +
                '<h2>Your Tier 1 Terms</h2>' +
                '<div class="alert alert-info mb-3">' +
                '<span>‚ÑπÔ∏è</span>' +
                '<span>These are preliminary terms based on your estimates. Connect your accounts to unlock better rates!</span>' +
                '</div>' +
                '<div class="mini-dashboard mb-3">' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">$50,000</div>' +
                '<div class="mini-card-label">Loan Amount</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">9.25%</div>' +
                '<div class="mini-card-label">Interest Rate</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">36 mo</div>' +
                '<div class="mini-card-label">Term Length</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">$1,250</div>' +
                '<div class="mini-card-label">Monthly Payment</div>' +
                '</div>' +
                '</div>' +
                '<div class="card" style="background: var(--bg-light); border: 2px solid var(--warm-gold);">' +
                '<h3>Want Better Terms?</h3>' +
                '<p class="text-muted mb-2">Connect your bank accounts and business data to potentially lower your rate to 7.5% or below!</p>' +
                '<ul class="checklist">' +
                '<li><span class="checklist-icon pending">‚óã</span> Bank Account: -0.25% to -0.75%</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Retirement Accounts: -0.25%</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Income Verification: -0.25%</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Tax Returns: Better amount</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Property Records: -0.25%</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Accounting Software: Lower payment</li>' +
                '</ul>' +
                '</div>' +
                '<div class="mt-3">' +
                '<button onclick="navigate(\'application-fee\')" class="btn btn-primary">Accept These Terms</button>' +
                '<button onclick="navigate(\'gate3-integrations\')" class="btn btn-success">Connect Data for Better Terms</button>' +
                '</div>' +
                '</div>';
        }

        function screenApplicationFee() {
            return '<div class="card">' +
                '<h2>Application Fee</h2>' +
                '<p class="text-muted mb-3">A small fee helps us process your application</p>' +
                '<div class="alert alert-info mb-3">' +
                '<span>‚ÑπÔ∏è</span>' +
                '<span>This fee is refundable if you are not approved</span>' +
                '</div>' +
                '<div class="mini-dashboard mb-3">' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">$99</div>' +
                '<div class="mini-card-label">Application Fee</div>' +
                '</div>' +
                '</div>' +
                '<form onsubmit="navigate(\'gate3-integrations\'); return false;">' +
                '<div class="form-group">' +
                '<label>Card Number</label>' +
                '<input type="text" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />' +
                '</div>' +
                '<div class="form-row">' +
                '<div class="form-group">' +
                '<label>Expiration</label>' +
                '<input type="text" placeholder="MM/YY" required />' +
                '</div>' +
                '<div class="form-group">' +
                '<label>CVV</label>' +
                '<input type="text" placeholder="‚Ä¢‚Ä¢‚Ä¢" required />' +
                '</div>' +
                '</div>' +
                '<button type="submit" class="btn btn-primary">Pay $99 & Continue</button>' +
                '</form>' +
                '</div>';
        }

        function screenGate3Integrations() {
            return '<div class="gate-stepper">' +
                '<div class="gate-step completed">' +
                '<div class="gate-step-circle">‚úì</div>' +
                '<div class="gate-step-label">Intent</div>' +
                '</div>' +
                '<div class="gate-step completed">' +
                '<div class="gate-step-circle">‚úì</div>' +
                '<div class="gate-step-label">Verification</div>' +
                '</div>' +
                '<div class="gate-step active">' +
                '<div class="gate-step-circle">3</div>' +
                '<div class="gate-step-label">Integration</div>' +
                '</div>' +
                '<div class="gate-step">' +
                '<div class="gate-step-circle">4</div>' +
                '<div class="gate-step-label">Approval</div>' +
                '</div>' +
                '</div>' +
                '<h2 class="mb-3">Gate 3: Connect Your Data</h2>' +
                '<div class="alert alert-success mb-3">' +
                '<span>‚úì</span>' +
                '<span>Each integration you connect improves your terms in real-time!</span>' +
                '</div>' +
                '<div class="two-col-layout">' +
                '<div>' +
                '<div class="integration-grid">' +
                '<div class="integration-card" id="int-bank">' +
                '<div class="integration-icon">üè¶</div>' +
                '<div class="integration-title">Bank Account</div>' +
                '<div class="integration-desc">Connect your business checking account</div>' +
                '<button class="btn btn-primary" onclick="connectIntegration(\'bank\')">Connect</button>' +
                '</div>' +
                '<div class="integration-card" id="int-retirement">' +
                '<div class="integration-icon">üíº</div>' +
                '<div class="integration-title">Retirement Accounts</div>' +
                '<div class="integration-desc">Show your retirement savings</div>' +
                '<button class="btn btn-primary" onclick="connectIntegration(\'retirement\')">Connect</button>' +
                '</div>' +
                '<div class="integration-card" id="int-income">' +
                '<div class="integration-icon">üìä</div>' +
                '<div class="integration-title">Income Verification</div>' +
                '<div class="integration-desc">Verify your income streams</div>' +
                '<button class="btn btn-primary" onclick="connectIntegration(\'income\')">Connect</button>' +
                '</div>' +
                '<div class="integration-card" id="int-tax">' +
                '<div class="integration-icon">üìÑ</div>' +
                '<div class="integration-title">Tax Returns</div>' +
                '<div class="integration-desc">Upload last 2 years tax returns</div>' +
                '<button class="btn btn-primary" onclick="connectIntegration(\'tax\')">Connect</button>' +
                '</div>' +
                '<div class="integration-card" id="int-property">' +
                '<div class="integration-icon">üè†</div>' +
                '<div class="integration-title">Property Records</div>' +
                '<div class="integration-desc">Show property ownership</div>' +
                '<button class="btn btn-primary" onclick="connectIntegration(\'property\')">Connect</button>' +
                '</div>' +
                '<div class="integration-card" id="int-accounting">' +
                '<div class="integration-icon">üìà</div>' +
                '<div class="integration-title">Accounting Software</div>' +
                '<div class="integration-desc">Connect QuickBooks or Xero</div>' +
                '<button class="btn btn-primary" onclick="connectIntegration(\'accounting\')">Connect</button>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div>' +
                '<div class="terms-sidebar">' +
                '<h3>Live Terms</h3>' +
                '<div class="terms-item" id="term-rate">' +
                '<div class="terms-label">Interest Rate</div>' +
                '<div class="terms-value">9.25%</div>' +
                '</div>' +
                '<div class="terms-item" id="term-amount">' +
                '<div class="terms-label">Loan Amount</div>' +
                '<div class="terms-value">$50,000</div>' +
                '</div>' +
                '<div class="terms-item" id="term-payment">' +
                '<div class="terms-label">Monthly Payment</div>' +
                '<div class="terms-value">$1,250</div>' +
                '</div>' +
                '<button class="btn btn-success mt-3" style="width: 100%;" onclick="navigate(\'analysis\')">Continue with These Terms</button>' +
                '</div>' +
                '</div>' +
                '</div>';
        }

        function screenAnalysis() {
            return '<div class="card text-center">' +
                '<div class="spinner"></div>' +
                '<h2 class="mt-3">Analyzing Your Data</h2>' +
                '<p class="text-muted">Our AI is reviewing your financial information...</p>' +
                '<div class="progress-bar mt-3">' +
                '<div class="progress-fill" style="width: 60%"></div>' +
                '</div>' +
                '<p class="text-muted mt-2">This usually takes 2-3 minutes</p>' +
                '</div>' +
                '<script>setTimeout(function() { navigate("tier2-terms"); }, 3000);</script>';
        }

        function screenTier2Terms() {
            return '<div class="card">' +
                '<div class="alert alert-success mb-3">' +
                '<span>‚úì</span>' +
                '<span>Great news! Your terms have improved significantly</span>' +
                '</div>' +
                '<h2>Your Final Terms</h2>' +
                '<div class="stats-grid mb-3">' +
                '<div class="stat-card">' +
                '<div class="stat-label">Loan Amount</div>' +
                '<div class="stat-value">$55,000</div>' +
                '<div class="stat-change positive">+$5,000 from Tier 1</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Interest Rate</div>' +
                '<div class="stat-value">8.25%</div>' +
                '<div class="stat-change positive">-1.00% from Tier 1</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Term Length</div>' +
                '<div class="stat-value">36 months</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Monthly Payment</div>' +
                '<div class="stat-value">$1,095</div>' +
                '<div class="stat-change positive">-$155 from Tier 1</div>' +
                '</div>' +
                '</div>' +
                '<div class="card" style="background: var(--bg-light);">' +
                '<h3>How Your Connections Helped</h3>' +
                '<div class="mini-dashboard">' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">-0.50%</div>' +
                '<div class="mini-card-label">Bank Account</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">-0.25%</div>' +
                '<div class="mini-card-label">Retirement</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">-0.25%</div>' +
                '<div class="mini-card-label">Income Verified</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">+$5K</div>' +
                '<div class="mini-card-label">Tax Returns</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="mt-3">' +
                '<button onclick="navigate(\'under-review\')" class="btn btn-primary">Accept Final Terms</button>' +
                '<button onclick="navigate(\'gate3-integrations\')" class="btn btn-outline">Go Back</button>' +
                '</div>' +
                '</div>';
        }

        function screenUnderReview() {
            return '<div class="card text-center">' +
                '<h2>Application Under Review</h2>' +
                '<p class="text-muted mb-3">Our underwriting team is reviewing your application</p>' +
                '<div class="gauge" style="--gauge-angle: 270deg;">' +
                '<div class="gauge-circle">' +
                '<div class="gauge-inner">' +
                '<div class="gauge-value">75%</div>' +
                '<div class="gauge-label">Complete</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="timeline mt-3">' +
                '<div class="timeline-item completed">' +
                '<div class="timeline-date">Today, 10:00 AM</div>' +
                '<div class="timeline-content">' +
                '<strong>Application Submitted</strong>' +
                '<p class="text-muted">Your application has been received</p>' +
                '</div>' +
                '</div>' +
                '<div class="timeline-item completed">' +
                '<div class="timeline-date">Today, 10:15 AM</div>' +
                '<div class="timeline-content">' +
                '<strong>Data Verification</strong>' +
                '<p class="text-muted">All integrations verified successfully</p>' +
                '</div>' +
                '</div>' +
                '<div class="timeline-item completed">' +
                '<div class="timeline-date">Today, 10:30 AM</div>' +
                '<div class="timeline-content">' +
                '<strong>AI Analysis Complete</strong>' +
                '<p class="text-muted">Risk assessment completed</p>' +
                '</div>' +
                '</div>' +
                '<div class="timeline-item">' +
                '<div class="timeline-date">In Progress</div>' +
                '<div class="timeline-content">' +
                '<strong>Human Review</strong>' +
                '<p class="text-muted">Senior underwriter reviewing application</p>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<button onclick="navigate(\'approved\')" class="btn btn-primary mt-3">Simulate Approval</button>' +
                '</div>';
        }

        function screenApproved() {
            return '<div class="card text-center">' +
                '<div style="font-size: 80px; margin-bottom: 20px;">üéâ</div>' +
                '<h1 style="color: var(--success);">Congratulations!</h1>' +
                '<h2>Your Loan is Approved</h2>' +
                '<div class="stats-grid mt-3 mb-3">' +
                '<div class="stat-card">' +
                '<div class="stat-label">Approved Amount</div>' +
                '<div class="stat-value">$55,000</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Interest Rate</div>' +
                '<div class="stat-value">8.25%</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Monthly Payment</div>' +
                '<div class="stat-value">$1,095</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">First Payment</div>' +
                '<div class="stat-value">Mar 15</div>' +
                '</div>' +
                '</div>' +
                '<div class="alert alert-success mb-3">' +
                '<span>‚úì</span>' +
                '<span>Your mentor has been assigned - Sarah Johnson will reach out within 24 hours</span>' +
                '</div>' +
                '<button onclick="navigate(\'closing\')" class="btn btn-primary">Proceed to Closing</button>' +
                '</div>';
        }

        function screenDenied() {
            return '<div class="card text-center">' +
                '<div style="font-size: 80px; margin-bottom: 20px;">üòû</div>' +
                '<h2>Application Not Approved</h2>' +
                '<p class="text-muted mb-3">Unfortunately, we are unable to approve your application at this time</p>' +
                '<div class="card" style="background: var(--bg-light); text-align: left;">' +
                '<h3>Reasons for Denial</h3>' +
                '<ul>' +
                '<li>Debt-to-income ratio exceeds our limits</li>' +
                '<li>Insufficient business revenue history</li>' +
                '<li>Recent credit issues detected</li>' +
                '</ul>' +
                '</div>' +
                '<div class="card" style="background: var(--bg-light); text-align: left; margin-top: 20px;">' +
                '<h3>Next Steps</h3>' +
                '<p>We want to help you succeed. Here are some recommendations:</p>' +
                '<ul>' +
                '<li>Work with our free business mentor to improve your financials</li>' +
                '<li>Reduce outstanding debt and reapply in 6 months</li>' +
                '<li>Consider alternative funding options we can recommend</li>' +
                '</ul>' +
                '</div>' +
                '<button onclick="navigate(\'mentorship\')" class="btn btn-primary mt-3">Connect with a Mentor</button>' +
                '</div>';
        }

        function screenClosing() {
            return '<div class="card">' +
                '<h2>Loan Closing Documents</h2>' +
                '<p class="text-muted mb-3">Review and sign your loan documents</p>' +
                '<ul class="doc-list mb-3">' +
                '<li class="doc-item">' +
                '<div class="doc-info">' +
                '<div class="doc-icon">üìÑ</div>' +
                '<div>' +
                '<div class="doc-name">Loan Agreement</div>' +
                '<div class="doc-size">2.4 MB PDF</div>' +
                '</div>' +
                '</div>' +
                '<button class="btn btn-outline">Review</button>' +
                '</li>' +
                '<li class="doc-item">' +
                '<div class="doc-info">' +
                '<div class="doc-icon">üìÑ</div>' +
                '<div>' +
                '<div class="doc-name">Promissory Note</div>' +
                '<div class="doc-size">1.8 MB PDF</div>' +
                '</div>' +
                '</div>' +
                '<button class="btn btn-outline">Review</button>' +
                '</li>' +
                '<li class="doc-item">' +
                '<div class="doc-info">' +
                '<div class="doc-icon">üìÑ</div>' +
                '<div>' +
                '<div class="doc-name">Truth in Lending Disclosure</div>' +
                '<div class="doc-size">890 KB PDF</div>' +
                '</div>' +
                '</div>' +
                '<button class="btn btn-outline">Review</button>' +
                '</li>' +
                '<li class="doc-item">' +
                '<div class="doc-info">' +
                '<div class="doc-icon">üìÑ</div>' +
                '<div>' +
                '<div class="doc-name">ACH Authorization</div>' +
                '<div class="doc-size">650 KB PDF</div>' +
                '</div>' +
                '</div>' +
                '<button class="btn btn-outline">Review</button>' +
                '</li>' +
                '</ul>' +
                '<div class="form-group">' +
                '<label>' +
                '<input type="checkbox" required /> ' +
                'I have reviewed all documents and agree to the terms' +
                '</label>' +
                '</div>' +
                '<div class="form-group">' +
                '<label>Electronic Signature</label>' +
                '<input type="text" placeholder="Type your full name" />' +
                '</div>' +
                '<button onclick="navigate(\'funded\')" class="btn btn-primary">Sign & Complete</button>' +
                '</div>';
        }

        function screenFunded() {
            return '<div class="card text-center">' +
                '<div style="font-size: 80px; margin-bottom: 20px;">üí∞</div>' +
                '<h1 style="color: var(--success);">Funds Disbursed!</h1>' +
                '<h2>$55,000 has been deposited to your account</h2>' +
                '<p class="text-muted mb-3">Your loan is now active</p>' +
                '<div class="stats-grid mt-3 mb-3">' +
                '<div class="stat-card">' +
                '<div class="stat-label">Loan Amount</div>' +
                '<div class="stat-value">$55,000</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">First Payment Due</div>' +
                '<div class="stat-value">Mar 15, 2026</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Monthly Payment</div>' +
                '<div class="stat-value">$1,095</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Remaining Balance</div>' +
                '<div class="stat-value">$55,000</div>' +
                '</div>' +
                '</div>' +
                '<div class="alert alert-info mb-3">' +
                '<span>‚ÑπÔ∏è</span>' +
                '<span>Set up autopay to never miss a payment and potentially qualify for a rate discount</span>' +
                '</div>' +
                '<div class="mt-3">' +
                '<button onclick="navigate(\'my-loans\')" class="btn btn-primary">View My Loans</button>' +
                '<button onclick="navigate(\'mentorship\')" class="btn btn-secondary">Meet My Mentor</button>' +
                '</div>' +
                '</div>';
        }

        function screenMyLoans() {
            return '<h1>My Loans</h1>' +
                '<div class="card mb-3">' +
                '<h3>Active Loans</h3>' +
                '<table class="table">' +
                '<thead>' +
                '<tr>' +
                '<th>Loan ID</th>' +
                '<th>Original Amount</th>' +
                '<th>Balance</th>' +
                '<th>Rate</th>' +
                '<th>Payment</th>' +
                '<th>Next Due</th>' +
                '<th>Status</th>' +
                '</tr>' +
                '</thead>' +
                '<tbody>' +
                '<tr>' +
                '<td>CLX-2026-1234</td>' +
                '<td>$55,000</td>' +
                '<td>$52,150</td>' +
                '<td>8.25%</td>' +
                '<td>$1,095</td>' +
                '<td>Mar 15, 2026</td>' +
                '<td><span class="badge badge-success">Current</span></td>' +
                '</tr>' +
                '<tr>' +
                '<td>CLX-2024-8765</td>' +
                '<td>$25,000</td>' +
                '<td>$8,420</td>' +
                '<td>9.50%</td>' +
                '<td>$825</td>' +
                '<td>Mar 1, 2026</td>' +
                '<td><span class="badge badge-success">Current</span></td>' +
                '</tr>' +
                '</tbody>' +
                '</table>' +
                '</div>' +
                '<div class="cards-grid">' +
                '<div class="card">' +
                '<h3>Payment History</h3>' +
                '<div class="timeline">' +
                '<div class="timeline-item completed">' +
                '<div class="timeline-date">Feb 15, 2026</div>' +
                '<div class="timeline-content">' +
                '<strong>Payment Received</strong>' +
                '<p class="text-muted">$1,095.00</p>' +
                '</div>' +
                '</div>' +
                '<div class="timeline-item completed">' +
                '<div class="timeline-date">Jan 15, 2026</div>' +
                '<div class="timeline-content">' +
                '<strong>Payment Received</strong>' +
                '<p class="text-muted">$1,095.00</p>' +
                '</div>' +
                '</div>' +
                '<div class="timeline-item completed">' +
                '<div class="timeline-date">Dec 15, 2025</div>' +
                '<div class="timeline-content">' +
                '<strong>Payment Received</strong>' +
                '<p class="text-muted">$1,095.00</p>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h3>Quick Actions</h3>' +
                '<button class="btn btn-primary mb-2" style="width: 100%;">Make a Payment</button>' +
                '<button class="btn btn-outline mb-2" style="width: 100%;">Set Up Autopay</button>' +
                '<button class="btn btn-outline mb-2" style="width: 100%;">Download Statement</button>' +
                '<button class="btn btn-outline mb-2" style="width: 100%;">Request Payoff Quote</button>' +
                '</div>' +
                '</div>';
        }

        function screenMentorship() {
            return '<h1>Business Mentorship</h1>' +
                '<div class="alert alert-success mb-3">' +
                '<span>‚úì</span>' +
                '<span>Complimentary mentorship included with your loan</span>' +
                '</div>' +
                '<div class="mentor-card">' +
                '<div class="mentor-avatar">SJ</div>' +
                '<div class="mentor-info">' +
                '<div class="mentor-name">Sarah Johnson</div>' +
                '<div class="mentor-title">Senior Business Advisor - 15 years experience</div>' +
                '<div class="mentor-stats">' +
                '<span class="mentor-stat"><strong>87</strong> clients mentored</span>' +
                '<span class="mentor-stat"><strong>4.9</strong> average rating</span>' +
                '<span class="mentor-stat"><strong>Retail & Services</strong> specialty</span>' +
                '</div>' +
                '</div>' +
                '<button class="btn btn-primary">Schedule Session</button>' +
                '</div>' +
                '<div class="cards-grid mt-3">' +
                '<div class="card">' +
                '<h3>Upcoming Sessions</h3>' +
                '<div class="timeline">' +
                '<div class="timeline-item">' +
                '<div class="timeline-date">Mar 15, 2026 at 2:00 PM</div>' +
                '<div class="timeline-content">' +
                '<strong>Financial Planning Review</strong>' +
                '<p class="text-muted">60 minute session via Zoom</p>' +
                '<button class="btn btn-outline mt-2">Join Meeting</button>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="card">' +
                '<h3>Past Sessions</h3>' +
                '<ul class="checklist">' +
                '<li><span class="checklist-icon">‚úì</span> Cash Flow Management (Feb 1)</li>' +
                '<li><span class="checklist-icon">‚úì</span> Marketing Strategy (Jan 15)</li>' +
                '<li><span class="checklist-icon">‚úì</span> Initial Assessment (Jan 5)</li>' +
                '</ul>' +
                '</div>' +
                '</div>' +
                '<div class="card mt-3">' +
                '<h3>Resources & Tools</h3>' +
                '<div class="cards-grid">' +
                '<div class="card" style="background: var(--bg-light);">' +
                '<div class="card-icon">üìä</div>' +
                '<h3>Business Planning</h3>' +
                '<p class="text-muted">Templates and guides</p>' +
                '<button class="btn btn-outline">View Resources</button>' +
                '</div>' +
                '<div class="card" style="background: var(--bg-light);">' +
                '<div class="card-icon">üí°</div>' +
                '<h3>Growth Strategies</h3>' +
                '<p class="text-muted">Scaling your business</p>' +
                '<button class="btn btn-outline">View Resources</button>' +
                '</div>' +
                '<div class="card" style="background: var(--bg-light);">' +
                '<div class="card-icon">üìà</div>' +
                '<h3>Financial Management</h3>' +
                '<p class="text-muted">Budgeting and forecasting</p>' +
                '<button class="btn btn-outline">View Resources</button>' +
                '</div>' +
                '</div>' +
                '</div>';
        }

        function screenFinancialHealth() {
            return '<h1>Financial Health Dashboard</h1>' +
                '<div class="stats-grid mb-3">' +
                '<div class="stat-card">' +
                '<div class="stat-label">Health Score</div>' +
                '<div class="stat-value">82</div>' +
                '<div class="stat-change positive">+5 from last month</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Cash Runway</div>' +
                '<div class="stat-value">4.2 mo</div>' +
                '<div class="stat-change positive">+0.5 mo</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Debt Coverage</div>' +
                '<div class="stat-value">2.1x</div>' +
                '<div class="stat-change positive">Healthy</div>' +
                '</div>' +
                '<div class="stat-card">' +
                '<div class="stat-label">Revenue Growth</div>' +
                '<div class="stat-value">+18%</div>' +
                '<div class="stat-change positive">Year over year</div>' +
                '</div>' +
                '</div>' +
                '<div class="cards-grid">' +
                '<div class="card">' +
                '<h3>Overall Health Score</h3>' +
                '<div class="gauge" style="--gauge-angle: 295deg;">' +
                '<div class="gauge-circle">' +
                '<div class="gauge-inner">' +
                '<div class="gauge-value">82</div>' +
                '<div class="gauge-label">Healthy</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<p class="text-center text-muted">Based on cash flow, debt ratio, and growth trends</p>' +
                '</div>' +
                '<div class="card">' +
                '<h3>Key Metrics</h3>' +
                '<div class="mini-dashboard">' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">$42K</div>' +
                '<div class="mini-card-label">Avg Monthly Revenue</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">$28K</div>' +
                '<div class="mini-card-label">Avg Monthly Expenses</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">$14K</div>' +
                '<div class="mini-card-label">Avg Monthly Profit</div>' +
                '</div>' +
                '<div class="mini-card">' +
                '<div class="mini-card-value">33%</div>' +
                '<div class="mini-card-label">Profit Margin</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="card mt-3">' +
                '<h3>Cash Flow Trend</h3>' +
                '<div class="bar-chart">' +
                '<div class="bar" style="height: 60%;">' +
                '<div class="bar-value">$12K</div>' +
                '<div class="bar-label">Jan</div>' +
                '</div>' +
                '<div class="bar" style="height: 70%;">' +
                '<div class="bar-value">$14K</div>' +
                '<div class="bar-label">Feb</div>' +
                '</div>' +
                '<div class="bar" style="height: 55%;">' +
                '<div class="bar-value">$11K</div>' +
                '<div class="bar-label">Mar</div>' +
                '</div>' +
                '<div class="bar" style="height: 80%;">' +
                '<div class="bar-value">$16K</div>' +
                '<div class="bar-label">Apr</div>' +
                '</div>' +
                '<div class="bar" style="height: 75%;">' +
                '<div class="bar-value">$15K</div>' +
                '<div class="bar-label">May</div>' +
                '</div>' +
                '<div class="bar" style="height: 85%;">' +
                '<div class="bar-value">$17K</div>' +
                '<div class="bar-label">Jun</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="cards-grid mt-3">' +
                '<div class="card">' +
                '<h3>Recommendations</h3>' +
                '<ul class="checklist">' +
                '<li><span class="checklist-icon">‚úì</span> Build emergency fund (3-6 months)</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Reduce credit card balances</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Increase profit margins by 5%</li>' +
                '<li><span class="checklist-icon pending">‚óã</span> Diversify revenue streams</li>' +
                '</ul>' +
                '</div>' +
                '<div class="card">' +
                '<h3>Insights</h3>' +
                '<div class="alert alert-success">' +
                '<span>‚úì</span>' +
                '<span>Strong revenue growth trend</span>' +
                '</div>' +
                '<div class="alert alert-warning">' +
                '<span>‚ö†</span>' +
                '<span>Seasonal fluctuations detected</span>' +
                '</div>' +
                '<div class="alert alert-info">' +
                '<span>‚ÑπÔ∏è</span>' +
                '<span>Consider discussing expansion with your mentor</span>' +
                '</div>' +
                '</div>' +
                '</div>';
        }

        // PART 2: LENDER SCREENS GO HERE

        // Screen Registry (extensible for Part 2)
        const screens = {};
        Object.assign(screens, {
            'landing': screenLanding,
            'signup': screenSignup,
            'welcome': screenWelcome,
            'dashboard': screenDashboard,
            'gate1-intent': screenGate1Intent,
            'gate2a-credit': screenGate2aCredit,
            'gate2b-kyc': screenGate2bKyc,
            'gate2c-business': screenGate2cBusiness,
            'gate25-guestimates': screenGate25Guestimates,
            'tier1-terms': screenTier1Terms,
            'application-fee': screenApplicationFee,
            'gate3-integrations': screenGate3Integrations,
            'analysis': screenAnalysis,
            'tier2-terms': screenTier2Terms,
            'under-review': screenUnderReview,
            'approved': screenApproved,
            'denied': screenDenied,
            'closing': screenClosing,
            'funded': screenFunded,
            'my-loans': screenMyLoans,
            'mentorship': screenMentorship,
            'financial-health': screenFinancialHealth
        });

        // Integration Connection Handler
        function connectIntegration(type) {
            if (appState.loanData.integrationsConnected.includes(type)) {
                return;
            }

            appState.loanData.integrationsConnected.push(type);

            const card = document.getElementById('int-' + type);
            card.classList.add('connected');
            card.querySelector('button').innerHTML = 'Connected ‚úì';
            card.querySelector('button').className = 'btn btn-success';
            card.querySelector('button').disabled = true;

            let newRate = appState.loanData.rate;
            let newAmount = appState.loanData.requestedAmount;
            let newPayment = appState.loanData.monthlyPayment;
            let improvement = '';

            if (type === 'bank') {
                newRate = 9.00;
                improvement = '-0.25%';
            } else if (type === 'retirement') {
                newRate = 8.75;
                improvement = '-0.25%';
            } else if (type === 'income') {
                newRate = 8.50;
                improvement = '-0.25%';
            } else if (type === 'tax') {
                newAmount = 55000;
                improvement = '+$5,000';
            } else if (type === 'property') {
                newRate = 8.25;
                improvement = '-0.25%';
            } else if (type === 'accounting') {
                newPayment = 1095;
                improvement = 'Recalculated';
            }

            appState.loanData.rate = newRate;
            appState.loanData.requestedAmount = newAmount;
            appState.loanData.monthlyPayment = newPayment;

            const rateEl = document.getElementById('term-rate');
            const amountEl = document.getElementById('term-amount');
            const paymentEl = document.getElementById('term-payment');

            if (type === 'bank' || type === 'retirement' || type === 'income' || type === 'property') {
                rateEl.classList.add('updated');
                rateEl.querySelector('.terms-value').textContent = newRate.toFixed(2) + '%';
                if (!rateEl.querySelector('.terms-improvement')) {
                    const improvementEl = document.createElement('div');
                    improvementEl.className = 'terms-improvement';
                    improvementEl.textContent = improvement;
                    rateEl.appendChild(improvementEl);
                }
                setTimeout(function() { rateEl.classList.remove('updated'); }, 600);
            }

            if (type === 'tax') {
                amountEl.classList.add('updated');
                amountEl.querySelector('.terms-value').textContent = '$' + newAmount.toLocaleString();
                if (!amountEl.querySelector('.terms-improvement')) {
                    const improvementEl = document.createElement('div');
                    improvementEl.className = 'terms-improvement';
                    improvementEl.textContent = improvement;
                    amountEl.appendChild(improvementEl);
                }
                setTimeout(function() { amountEl.classList.remove('updated'); }, 600);
            }

            if (type === 'accounting') {
                paymentEl.classList.add('updated');
                paymentEl.querySelector('.terms-value').textContent = '$' + newPayment.toLocaleString();
                if (!paymentEl.querySelector('.terms-improvement')) {
                    const improvementEl = document.createElement('div');
                    improvementEl.className = 'terms-improvement';
                    improvementEl.textContent = improvement;
                    paymentEl.appendChild(improvementEl);
                }
                setTimeout(function() { paymentEl.classList.remove('updated'); }, 600);
            }
        }

        // Navigation
        function navigate(screenId) {
            appState.currentScreen = screenId;
            renderScreen();
            renderNavigation();
        }

        function switchRole() {
            const select = document.getElementById('roleSelect');
            appState.currentRole = select.value;
            appState.currentScreen = navigationData[appState.currentRole][0].id;
            renderScreen();
            renderNavigation();
        }

        function renderNavigation() {
            const sidebar = document.getElementById('sidebar');
            const navItems = navigationData[appState.currentRole];

            let html = '<div class="sidebar-logo">CremoLogix</div>';
            html += '<ul class="sidebar-nav">';

            navItems.forEach(function(item) {
                const activeClass = item.id === appState.currentScreen ? 'active' : '';
                html += '<li><a href="#" class="' + activeClass + '" onclick="navigate(\'' + item.id + '\'); return false;">' + item.label + '</a></li>';
            });

            html += '</ul>';
            sidebar.innerHTML = html;
        }

        function renderScreen() {
            const content = document.getElementById('mainContent');
            const screenFunc = screens[appState.currentScreen];

            if (screenFunc) {
                content.innerHTML = '<div class="fade-in">' + screenFunc() + '</div>';
            } else {
                content.innerHTML = '<div class="card"><h2>Screen Not Found</h2><p>Screen ID: ' + appState.currentScreen + '</p></div>';
            }
        }

        // Initialize
        renderNavigation();
        renderScreen();
    </script>
</body>
</html>